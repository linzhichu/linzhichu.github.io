---
layout: post
title: Python threading 模块
categories: computers
tags: Python
---
<div class="org-src-container">

<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">func</span>():
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span> <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(3):
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span>   <span class="org-keyword">print</span>

ss
<span class="org-keyword">def</span> <span class="org-function-name">ff</span>():
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span> <span class="org-keyword">print</span> xx
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span> <span class="org-keyword">print</span> yy
</pre>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">最简单的多线程实现</h2>
<div class="outline-text-2" id="text-1">
<p>
通过为 <code>Thread</code> 传入 <code>target</code> 参数可以启动一个最简单的线程
</p>
<div class="org-src-container">

<pre class="src src-python"><span class="org-keyword">import</span> time
<span class="org-keyword">from</span> threading <span class="org-keyword">import</span> Thread

<span class="org-keyword">def</span> <span class="org-function-name">thread_worker</span>():
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">xrange</span>(3):
        time.sleep(2)
        <span class="org-keyword">print</span> <span class="org-string">'threaded worker at %d'</span> % i


<span class="org-keyword">if</span> <span class="org-builtin">__name__</span> == <span class="org-string">'__main__'</span>:
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span>   <span class="org-variable-name">t</span> = Thread(target=thread_worker)
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span>   t.start()
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span>   time.sleep(0.5)
<span class="org-highlight-indentation"><span class="org-highlight-indentation"> </span></span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">xrange</span>(3):
        time.sleep(1)
        <span class="org-keyword">print</span> <span class="org-string">'main thread at %d'</span> % i
</pre>
</div>
<p>
从输出结果可以看到，两个线程互不干扰地各自执行
</p>
<div class="org-src-container">

<pre class="src src-sh">$ python test_thread.py 
main thread at 0
threaded worker at 0
main thread at 1
main thread at 2
threaded worker at 1
threaded worker at 2
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Thread对象</h2>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">daemon vs non-daemon</h2>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"></h2>
</div>
